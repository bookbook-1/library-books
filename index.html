<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 신착도서 전시회</title>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        :root {
            --primary-color: #1a1a1a;
            --bg-color: #ffffff;
            --card-shadow: 0 4px 20px rgba(0,0,0,0.05);
            --accent-color: #f3f4f6;
        }

        body { 
            font-family: 'Pretendard', sans-serif; background-color: var(--bg-color); 
            margin: 0; padding: 80px 40px; color: var(--primary-color);
            line-height: 1.6; overflow-x: hidden;
        }

        /* 1. 세련된 배경 타이포그래피 (수직 워터마크) */
        .bg-text {
            position: fixed; font-size: 8rem; font-weight: 900; 
            color: rgba(0,0,0,0.02); z-index: -1; user-select: none;
            writing-mode: vertical-rl; text-transform: uppercase; letter-spacing: 10px;
        }
        .bg-1 { top: 0; left: 20px; }
        .bg-2 { bottom: 0; right: 20px; transform: rotate(180deg); }

        header { text-align: center; margin-bottom: 80px; }
        h1 { font-size: 2.2rem; font-weight: 800; letter-spacing: -1px; margin-bottom: 10px; }
        .subtitle { color: #888; font-size: 1rem; }

        /* 2. 정갈한 그리드 레이아웃 */
        .gallery { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
            gap: 40px; max-width: 1200px; margin: 0 auto;
        }
        
        /* 3. 절제된 카드 디자인 및 호버 효과 */
        .book-card { 
            background: white; border-radius: 4px; padding: 20px;
            text-decoration: none; color: inherit; display: flex; flex-direction: column;
            transition: all 0.4s ease; border: 1px solid #eee;
            position: relative;
        }

        .book-card:hover { 
            transform: translateY(-10px) rotateX(5deg) rotateY(-5deg); /* 마우스 올릴 때만 살짝 3D */
            box-shadow: 20px 20px 40px rgba(0,0,0,0.08);
            border-color: #ddd;
        }

        /* 배지 스타일 */
        .badge {
            position: absolute; top: -10px; right: 10px; padding: 4px 12px; 
            color: white; font-weight: 700; font-size: 0.7rem; border-radius: 2px;
            z-index: 5;
        }
        .badge-신규 { background: #333; }
        .badge-추천 { background: #999; }
        .badge-인기 { background: #e63946; }

        .book-card img { 
            width: 100%; height: 320px; object-fit: contain; 
            margin-bottom: 20px; transition: 0.4s;
            filter: grayscale(20%); /* 차분한 느낌을 위해 채도 살짝 낮춤 */
        }
        .book-card:hover img { filter: grayscale(0%); transform: scale(1.02); }
        
        .title { font-size: 1.1rem; font-weight: 700; margin-bottom: 8px; color: #111; height: 3rem; overflow: hidden; }
        .info { font-size: 0.85rem; color: #999; margin-bottom: 15px; }
        .description { font-size: 0.9rem; color: #777; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }

        #status { text-align: center; color: #ccc; padding: 100px; font-weight: 300; }
    </style>
</head>
<body>

    <div id="bg-text-1" class="bg-text bg-1"></div>
    <div id="bg-text-2" class="bg-text bg-2"></div>

    <header>
        <h1>NEW ARRIVALS</h1>
        <div class="subtitle">광명 도서관 교직원 신착도서 전시회</div>
    </header>

    <div id="status">데이터를 불러오는 중입니다...</div>
    <div id="book-gallery" class="gallery"></div>

    <script>
        const sheetCsvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQvgpFiJL5vGTUdZk3u_cnRyXeZ-Ej5u_FC3HihBMHtHs17ZBSObgQe6aWDH3UFIHpu0oKy1TYhcKPP/pub?gid=0&single=true&output=csv&range=A:I";

        function parseCSV(text) {
            const rows = []; let row = []; let col = ''; let inQuotes = false;
            for (let i = 0; i < text.length; i++) {
                let char = text[i]; let next = text[i+1];
                if (char === '"' && inQuotes && next === '"') { col += '"'; i++; }
                else if (char === '"') { inQuotes = !inQuotes; }
                else if (char === ',' && !inQuotes) { row.push(col); col = ''; }
                else if (char === '\n' && !inQuotes) { row.push(col); rows.push(row); row = []; col = ''; }
                else if (char !== '\r') { col += char; }
            }
            if (col || row.length > 0) { row.push(col); rows.push(row); }
            return rows;
        }

        async function loadBooks() {
            try {
                const response = await fetch(sheetCsvUrl + "&t=" + new Date().getTime());
                const csvText = await response.text();
                const data = parseCSV(csvText);
                
                // 배경 타이포그래피 텍스트 (H1, I1)
                document.getElementById('bg-text-1').innerText = data[0][7] || "LIBRARY";
                document.getElementById('bg-text-2').innerText = data[0][8] || "EXHIBITION";

                const gallery = document.getElementById('book-gallery');
                gallery.innerHTML = ''; 

                for (let i = 1; i < data.length; i++) {
                    const cols = data[i];
                    if (cols.length >= 5) {
                        const title = cols[0].trim();
                        const author = cols[1] || '';
                        const pub = cols[2] || '';
                        const desc = cols[3] || '';
                        const img = cols[4] ? cols[4].trim() : '';
                        const link = cols[5] ? cols[5].trim() : '#';
                        const badgeText = cols[6] ? cols[6].trim() : ''; 

                        let badgeHtml = badgeText ? `<div class="badge badge-${badgeText}">${badgeText}</div>` : '';

                        if (img.startsWith('http')) {
                            gallery.innerHTML += `
                                <a href="${link}" target="_blank" class="book-card">
                                    ${badgeHtml}
                                    <img src="${img}" alt="${title}">
                                    <div class="title">${title}</div>
                                    <div class="info">${author} · ${pub}</div>
                                    <div class="description">${desc}</div>
                                </a>`;
                        }
                    }
                }
                document.getElementById('status').style.display = 'none';
            } catch (e) {
                document.getElementById('status').innerText = "로드 오류가 발생했습니다.";
            }
        }
        loadBooks();
    </script>
</body>
</html>
